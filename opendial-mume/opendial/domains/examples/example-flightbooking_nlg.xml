<?xml version="1.0" encoding="UTF-8"?>\n<domain>\n	<!-- Natural language generation models. The domain can produce new system \n		utterance either when the current step is changed, or when a new system action \n		is selected. -->\n\n\n	<model trigger="current_step">\n		<!--Model producing new system utterances when the current step is moved \n			to a new step. -->\n\n		<!-- Asks for the destination -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="Destination" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="What is your destination?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks for the departure -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="Departure" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="What is your departure?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks for the flight date -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="Date" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="On which date do you want to travel to {Destination}?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks whether to book a return trip -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="Return" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="Do you want to book a return trip?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks for the return date -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="ReturnDate" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="On which date do you want to travel back to {Departure}?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks for the number of tickets -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="NbTickets" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="How many tickets should I order?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks for the last confirmation -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="LastConfirm" />\n					<if var="ReturnDate" value="NoReturn" />\n					<if var="NbTickets" value="1"/>\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="You are ordering one one-way ticket from {Departure}\n					to {Destination} on {Date} for a total cost of {TotalCost} EUR. \n					Shall I confirm your order?" />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="current_step" value="LastConfirm" />\n					<if var="NbTickets" value="1"/>\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="You are ordering one round-trip ticket from {Departure}\n					to {Destination} on {Date} and returning on {ReturnDate}  for a total cost of \n					{TotalCost} EUR. Shall I confirm your order?" />\n				</effect>\n			</case>\n				<case>\n				<condition>\n					<if var="current_step" value="LastConfirm" />\n					<if var="ReturnDate" value="NoReturn" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="You are ordering {NbTickets} one-way tickets from {Departure}\n					to {Destination} on {Date} for a total cost of {TotalCost} EUR. \n					Shall I confirm your order?" />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="current_step" value="LastConfirm" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="You are ordering {NbTickets} round-trip tickets from {Departure}\n					to {Destination} on {Date} and returning on {ReturnDate}  for a total cost of \n					{TotalCost} EUR. Shall I confirm your order?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Asks whether to order additional tickets -->\n		<rule>\n			<case>\n				<condition operator="or">\n					<if var="current_step" value="Final" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="Do you want to order additional tickets?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Closes the interaction -->\n		<rule>\n			<case>\n				<condition>\n					<if var="current_step" value="Close" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="Thank you for your order and welcome back!" />\n				</effect>\n			</case>\n		</rule>\n\n\n	</model>\n\n\n	<model trigger="a_m">\n		<!-- Model producing new system utterances related to the last system action -->\n\n		<!-- grounding the destination -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(Destination,{Dest})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="OK, flying to {Dest}." />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- grounding the departure -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(Departure,{Depart})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="OK, flying from {Depart}." />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- grounding the flight date -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(Date,{Date})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="OK, flying from {Departure} to {Destination} on {Date}." />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- grounding the number of tickets -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(NbTickets,{Number})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="OK, {Number} tickets." />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- grounding the return date -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(ReturnDate,NoReturn)" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="OK, no return trip." />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(ReturnDate,{ReturnDate})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="OK, flying back from {Destination} to {Departure} on {ReturnDate}." />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- confirmation request for the destination -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Confirm(Destination,{Dest})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="You want to fly to {Dest}. Is that correct?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- confirmation request for the departure -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Confirm(Departure,{Depart})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="You want to fly from {Depart}. Is that correct?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- confirmation request for the flight date -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Confirm(Date,{Date1})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="You want to fly to {Destination} on {Date1}. Is that correct?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- confirmation request for the return date -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Confirm(ReturnDate,NoReturn)" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="Do you want to order a return trip?" />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="a_m" value="Confirm(ReturnDate,{Date2})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="You want to fly back to {Departure} on {Date2}. Is that correct?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- confirmation request for the number of tickets -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Confirm(NbTickets,{Number})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="You want to order {Number} tickets. Is that correct?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- repetition request -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="AskRepeat" />\n					<if var="current_step" value="(Destination|Departure)" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="Sorry, could you repeat? The available airports are Oslo, Bergen, \n					Trondheim, Stavanger, Moss,	Sandefjord, Tromsø, Bodø, Kristiansand and Ålesund." />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="a_m" value="AskRepeat" />\n					<if var="current_step" value="(Date|ReturnDate)" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="Sorry, could you repeat? Please state the month and day of\n					your desired flight." />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="a_m-prev" value="AskRepeat" />\n					<if var="a_m" value="AskRepeat" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="Sorry I couldn't understand you. Could you please repeat one more time?" />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="a_m" value="AskRepeat" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="Sorry, could you repeat?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Making a price offer -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="MakeOffer({Price})" />\n					<if var="ReturnDate" value="NoReturn" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="One-way flight tickets from {Departure} to {Destination} \n					on {Date} cost {Price} EUR per person. Do you want me to order tickets?" />\n				</effect>\n			</case>\n			<case>\n				<condition>\n					<if var="a_m" value="MakeOffer({Price})" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="Flight tickets from {Departure} to {Destination} on {Date} and returning \n						on {ReturnDate} cost {Price} EUR per person. Do you want me to order tickets?" />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Grounding the cancellation -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(Cancel)" />\n				</condition>\n				<effect util="1">\n					<set var="u_m" value="OK, your booking is now cancelled." />\n				</effect>\n			</case>\n		</rule>\n\n		<!-- Grounding the booking -->\n		<rule>\n			<case>\n				<condition>\n					<if var="a_m" value="Ground(Booking)" />\n				</condition>\n				<effect util="1">\n					<set var="u_m"\n						value="OK, your tickets are now ordered and will be sent to you via email." />\n				</effect>\n			</case>\n		</rule>\n\n		\n	</model>\n\n</domain>